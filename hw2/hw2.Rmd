---
title: "Biostat M280 Homework 2"
subtitle: Due Feb 16 @ 11:59PM
author: "Landi Luo"
date: "2/12/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Q1

Read [Chapter 7](http://r4ds.had.co.nz/exploratory-data-analysis.html) (Exploratory Data Analysis) of _R for Data Science_ and do exercises 7.3.4, 7.4.1, 7.5.1.1, 7.5.2.1, and 7.5.3.1.

### Exercise 7.3.4

1. Explore the distribution of each of the `x`, `y`, and `z` variables in `diamonds`. What do you learn? Think about a diamond and how you might decide which dimension is the length, width, and depth.  
    *The x variable has minimum value = 0 and maximum value = 10.74. The y variable has range 0 to 58.9. The z variable has range 0 to 31.8. When we look at the histograms of each variable, we can see that the distribution concentrates around 0 to 15, so I removed the outliers to better compare the variables. Thinking about the dimensions of a diamond, I would expect the length and width distributions to be approximately the same, and I would expect the depth to have smaller values in general. Comparing the three histograms as well as the scatterplot, the x and y variables have similar distributions so I would guess that x and y are the length and width, and z is the depth. *   
    ```{r}
    if (!"tidyverse" %in% rownames(installed.packages()))  
      install.packages("tidyverse", repos = "http://cran.rstudio.com/")
    library(tidyverse)
    
    # explore range of x, y, and z
    count(diamonds, min(x), max(x))
    count(diamonds, min(y), max(y))
    count(diamonds, min(z), max(z))
    
    # remove outliers
    diamonds2 <- diamonds %>% 
      filter(between(x, 0, 15), between(y, 0, 15), between(z, 0, 15))
    
    ggplot(data = diamonds2) + 
      geom_histogram(mapping = aes(x = x), binwidth = 0.5)  
    ggplot(data = diamonds2) + 
      geom_histogram(mapping = aes(x = y), binwidth = 0.5)
    ggplot(data = diamonds2) + 
      geom_histogram(mapping = aes(x = z), binwidth = 0.5)
    ggplot(data = diamonds2) + 
      geom_point(mapping = aes(x = x, y = y), color = "cadetblue") + 
      geom_point(mapping = aes(x = x, y = z), color = "lightpink")
    ```

2. Explore the distribution of `price`. Do you discover anything unusual or surprising? (Hint: Carefully think about the `binwidth` and make sure you try a wide range of values.)    
    *The prices of diamonds in the dataset ranges from $326 to $18823. I first set the histogram `binwidth` to 1000 because of the wide range of prices. The histogram shows a positive skew with mode at the $500-$1500 bin. I then tried a `binwidth` of 100 and noticed that there is an unusual gap in the histogram at x~1500. A further look at the data shows that there are no diamonds priced between $1455 and $1555. This finding is surprising considering that it is close to the mode of the histogram. *
    ```{r}
    count(diamonds, min(price), max(price)) 
    count(diamonds, cut_width(price, 1000))
    ggplot(data = diamonds) + 
      geom_histogram(mapping = aes(x = price), binwidth = 1000)
    ggplot(data = diamonds) + 
      geom_histogram(mapping = aes(x = price), binwidth = 100)
    
    #explore unusual price gap
    diamonds %>%
      filter(price > 1000 & price < 2000) %>%
      count(cut_width(price, 100))
    diamonds %>%
      filter(price > 1450 & price < 1550) %>%
      count(price)
    
    ```
3. How many diamonds are 0.99 carat? How many are 1 carat? What do you think is the cause of the difference?  
    *23 diamonds are 0.99 carat, and 1558 diamonds are 1 carat. This may be because 1 carat diamonds can sell for a much higher price than 0.99 carat diamonds, because the whole number seems like a lot more. *  
    ```{r}
    diamonds %>%
      filter(carat == 0.99 | carat == 1) %>%
      count(carat)
    ```

4. Compare and contrast `coord_cartesian()` vs `xlim()` or `ylim()` when zooming in on a histogram. What happens if you leave `binwidth` unset? What happens if you try and zoom so only half a bar shows?  
    *When we leave `binwidth` unset, R generates an automatic binwidth along with a warning message. Using coord_cartesian keeps the bin around 5, whereas using x_lim doesn't.  *  
    ```{r}
    #leaving binwidth unset
    ggplot(data = diamonds) + 
      geom_histogram(mapping = aes(x = x))
    
    ggplot(data = diamonds) + 
      geom_histogram(mapping = aes(x = x), binwidth = 0.1) +
      xlim(c(3,5)) +
      ylim(c(0,4000))
    ggplot(data = diamonds) + 
      geom_histogram(mapping = aes(x = x), binwidth = 0.1) +
      coord_cartesian(xlim = c(3,5), ylim = c(0,4000))
    ```
    

## Q2 (optional)

Read [Chapter 23](http://r4ds.had.co.nz/model-basics.html) (Model Basics) and [Chapter 24](http://r4ds.had.co.nz/model-building.html) (Model Building) of _R for Data Science_ and do exercises 24.2.3 and 24.3.5.

## Q3

Redo HW1 Q2 using tidyverse.

## Q4 (optional)

Redo HW1 Q3 on Hoffman2, except now we want to submit each `runSum.R` job to a different node in the cluster.
